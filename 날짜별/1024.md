### 1. 주소창에 주소를 검색했을 때 발생하는 일

#### 1.1. HTTPS 통신

1. 브라우저의 url 파싱 : url의 구조 해석
   - 어떤 프로토콜을 통해 url에 요청하는지
   - 어떤 url에 요청하는지
   - 어떤 포트에 요청하는지
2. HSTS 목록 조회
   - HSTS : HTTPS를 사용하는 연결만 허용하는 기능
   - HSTS 목록 : HSTS 캐시에 저장된 url
   - HSTS 목록에 존재하는 url을 http로 요청하더라도 https 통신으로 변경
3. url을 ip주소로 변환 : DNS 서버에 요청하여 url을 ip주소로 변경
   1. Local DNS에 url의 ip주소를 요청 → 존재한다면 응답, 아니라면 다른 DNS 서버와 통신
   2. root DNS 서버에 해당 url의 ip주소 요청 → 없다면 하위 DNS 서버에 요청하라고 응답
   3. Local DNS는 .com(혹은 .net) DNS 서버에 같은 내용 요청 → 없다면 하위 DNS 서버에 요청하라고 응답
   4. Local DNS는 naver.com DNS 서버에서 ip주소를 응답받아 해당 ip주소를 캐싱
4. 라우터를 통해 해당 서버의 게이트웨이까지 이동
   - 네트워크 장비인 라우터의 라우팅을 통해
5. ARP를 브로드캐스팅 하여 ip주소를 mac주소로 변환
6. 대상 서버와 TCP 소켓 연결
   1. 3 way handshaking
   2. TLS 핸드쉐이킹
7. HTTPS 프로토콜로 요청, 응답 : 요구했던 url 페이지를 달라고 서버에게 요청
8. 응답받은 내용을 렌더링하여 화면에 보여줌





#### 1.2. 3 way handshaking

> 양쪽 모두 데이터를 전송할 준비가 되었다는 것을 보장하고, 데이터를 전달하기 전에 한쪽이 다른쪽의 준비를 알 수 있도록 함

1. 클라이언트는 서버에 접속을 요청하는 SYN 패킷을 보낸다. 그리고 SYN/ACK 응답을 기다리는 SYN_SENT 상태가 된다
2. 서버는 SYN 요청을 받고 클라이언트에게 요청을 수락한다는 SYN/ACK 패킷을 보낸다. ACK로 응답하기를 기다리는 SYN_RECEIVED 상태가 된다
3. 클라이언트는 서버에게 ACK를 보내고 연결이 이루어진다. 서버는 ESTABLISHED 상태가 된다.



##### 1.2.1. 클라이언트로부터 ACK 응답이 오지 않으면?

- 서버는 일정 시간 기다린 뒤 연결을 종료하게 된다
- ACK 응답 대신 SYN 요청만 계속 보내면 SYN 플러딩이라고 한다





#### 1.3. 4 way handshaking

1. 클라이언트가 연결을 종료하겠다는 FIN 플래그를 보낸다
2. 서버는 확인 메시지를 보낸 뒤 자신의 통신이 끝날 때까지 기다린다
   - TIME_WAIT 상태
3. 서버가 통신이 끝나면 연결이 종료됐다고 클라이언트에게 FIN 플래그를 보낸다
4. 클라이언트는 확인 메시지를 보낸다



##### 1.3.1. 서버에서 FIN을 전송하기 전에 전송한 패킷이 Routing 지연이나 패킷 유실로 인한 재전송 등으로 인해 FIN 플래그보다 늦게 도착한다면?

- 클라이언트는 서버로부터 FIN을 수신하더라도 일정시간(기본 240초) 동안 세션을 남겨두고 잉여 패킷을 기다린다
  - TIME_WAIT